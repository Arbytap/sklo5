# Руководство по первоначальной настройке Worker Tracker Bot

## Подготовка среды

1. Установите все необходимые зависимости из requirements.txt

2. Создайте файл .env на основе .env.example:
   ```bash
   cp .env.example .env
   nano .env  # Или любой другой редактор для изменения файла
   ```

3. Получите токен бота у @BotFather в Telegram и добавьте его в .env файл

## Настройка администраторов

1. Найдите свой Telegram ID, отправив сообщение боту @userinfobot

2. Добавьте свой ID в файл .env в параметр ADMIN_IDS:
   ```
   ADMIN_IDS=ваш_id_здесь
   ```

3. Для нескольких администраторов, используйте запятую:
   ```
   ADMIN_IDS=123456789,987654321
   ```

## Запуск бота

1. Запустите бота в режиме polling для настройки:
   ```bash
   python standalone_polling_bot.py
   ```

2. В Telegram найдите своего бота и отправьте команду /start

3. Вы должны увидеть приветственное сообщение и клавиатуру с кнопками статусов

## Добавление пользователей

1. Как администратор, нажмите кнопку "Панель админа"

2. В админ-панели выберите "Управление пользователями"

3. Добавьте пользователей, указав их Telegram ID и полное имя

4. Пользователи могут активировать бота, отправив команду /start

## Настройка отчетов

1. Отчеты генерируются ежедневно в 17:30 (по умолчанию)

2. Для изменения времени генерации отчетов, отредактируйте scheduled_tasks.py:
   ```python
   # Найдите строку с DAILY_REPORT_TIME и измените значения
   DAILY_REPORT_TIME = {"hour": 17, "minute": 30}
   ```

3. Для ручной генерации отчетов используйте:
   - Команду /report YYYY-MM-DD в Telegram
   - Или интерфейс на веб-странице /reports

## Запуск в продакшн-режиме

1. Настройте webhook согласно WEBHOOK_SETUP_GUIDE.md:
   ```bash
   # Пример с Cloudflare Tunnel
   cloudflared tunnel --url http://localhost:5003
   ```

2. Обновите .env файл с полученным URL

3. Запустите бота в фоновом режиме:
   ```bash
   ./start_bot.sh
   ```

4. Проверьте работу бота через логи:
   ```bash
   tail -f bot_log.txt
   ```

## Создание тестовых данных (опционально)

1. Для тестирования карт и отчетов запустите:
   ```bash
   python create_test_route.py
   ```

2. Для добавления дополнительных тестовых точек:
   ```bash
   python add_more_test_points.py
   ```

3. Проверьте сгенерированные карты в корневой папке проекта
